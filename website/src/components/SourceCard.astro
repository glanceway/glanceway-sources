---
import { useTranslations, getLocalePath } from "../i18n/index";

interface Props {
  id: string;
  name: string;
  description: string;
  category: string;
  tags?: string[];
  author: string;
  type: "js" | "yaml";
  locale?: string;
}

const { id, name, description, category, tags, author, type, locale = "en" } = Astro.props;
const t = useTranslations(locale);

const categoryColors: Record<string, string> = {
  Developer: "bg-blue-50 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",
  News: "bg-amber-50 text-amber-700 dark:bg-amber-900/30 dark:text-amber-300",
  Social: "bg-pink-50 text-pink-700 dark:bg-pink-900/30 dark:text-pink-300",
  Finance: "bg-emerald-50 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-300",
  Entertainment: "bg-purple-50 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300",
  Productivity: "bg-cyan-50 text-cyan-700 dark:bg-cyan-900/30 dark:text-cyan-300",
  Other: "bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400",
};

const badgeClass = categoryColors[category] ?? categoryColors.Other;
---

<a
  href={getLocalePath(locale, `/source/${id}`)}
  class="group flex flex-col rounded-xl bg-white p-5 shadow-sm ring-1 ring-gray-200 no-underline transition-shadow hover:shadow-md hover:ring-gray-300 dark:bg-gray-900 dark:ring-gray-800 dark:hover:ring-gray-700"
  data-category={category}
>
  <div class="mb-1 flex items-start justify-between gap-2">
    <h3 class="text-[15px] font-semibold text-gray-900 group-hover:text-gray-600 dark:text-white dark:group-hover:text-gray-300">{name}</h3>
    <span class={`shrink-0 rounded-full px-2 py-0.5 text-[11px] font-medium ${badgeClass}`}>{t(`category.${category}` as any)}</span>
  </div>
  <span class="mb-2 text-xs text-gray-400 dark:text-gray-500">{t("detail.by")} {author}</span>
  <p class="flex-1 text-sm leading-relaxed text-gray-500 line-clamp-2 dark:text-gray-400">{description}</p>
  {
    tags && tags.length > 0 && (
      <div class="mt-3 truncate text-xs text-gray-400 dark:text-gray-500">
        {tags.map((t) => `#${t}`).join("\u2003")}
      </div>
    )
  }
</a>
